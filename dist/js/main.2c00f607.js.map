{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"electron\"","webpack:///external \"crypto\"","webpack:///external \"assert\"","webpack:///./src/components/ColorTip.vue?1f6d","webpack:///./src/assets/feather.svg","webpack:///./src/App.vue?0d3d","webpack:///external \"util\"","webpack:///external \"os\"","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///external \"worker_threads\"","webpack:///./src/App.vue?404f","webpack:///./src/components/ToolBar.vue?4b68","webpack:///./src/utils/arrowCoordinate.js","webpack:///src/components/ToolBar.vue","webpack:///./src/components/ToolBar.vue?ebc0","webpack:///./src/components/ToolBar.vue","webpack:///./src/components/ColorTip.vue?4f17","webpack:///./src/utils/RGB2HEX.js","webpack:///src/components/ColorTip.vue","webpack:///./src/components/ColorTip.vue?7914","webpack:///./src/components/ColorTip.vue","webpack:///./src/utils/captureScreen.js","webpack:///src/App.vue","webpack:///./src/App.vue?316f","webpack:///./src/App.vue","webpack:///./src/App.js","webpack:///./src/assets/brush.svg","webpack:///./src/components/ToolBar.vue?ee6a","webpack:///./src/assets/iphone.mp3","webpack:///external \"events\""],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","require","_vm","this","_h","$createElement","_c","_self","attrs","style","cursor","completeSelectRegion","on","onSelectRegion","directives","rawName","expression","ref","position","left","canvasX","top","canvasY","zIndex","pointerEvents","onDrag","x","y","width","height","toolbarBottom","canvasWidth","canvasHeight","clipDesktop","$event","initSelect","canDrag","isCapture","_e","visibility","win32","staticRenderFns","$emit","themeDark","_v","clickUndo","clickRedo","clickSquare","clickCircle","clickArrow","clickLine","clickText","clickBrush","clickLineShape","staticClass","background","_s","config","lineWidth","changeLineShape","borderColor","model","callback","$$v","$set","clickColor","lineColor","changeColor","clickSave","clickNo","clickYes","mp3path","x1","y1","x2","y2","l1","l2","angle","Math","PI","rotate","atan2","a1","sin","b1","cos","a2","b2","a3","b3","props","Number","canvasProps","components","ColorPicker","showColorPicker","showLineShape","inputText","fontSize","featherCursor","brushCursor","lineCap","lineDash","lineRadius50","lineShape","radius","recordsQueue","computed","selectLineStyle","border","borderBottom","borderRadius","mounted","displayRef","document","getElementById","displayCtx","getContext","assistRef","assistCtx","methods","colseDropDown","unshift","currentData","putImageData","preData","nextData","recordAndClearEvents","onmousemove","onmouseup","setStyle","strokeStyle","shadowColor","setLineDash","onmousedown","e","clientX","clientY","w","h","X2","Y2","textInput","className","contentEditable","color","padding","lineHeight","fontFamily","onblur","onkeydown","focus","ext","url","writeStream","write","imageBuffer","setTimeout","errNotification","close","clearRect","textInputs","forEach","body","silent","icon","notification","textInputBlur","text","split","font","fillStyle","rows","txt","$root","$el","removeChild","target","textInputKeyDown","innerHTML","component","staticStyle","textDecoration","switchColor","hex","rgba","RGB2Hex","values","replace","a","parseFloat","floor","parseInt","g","b","toString","hasCopy","tipboardStyle","mask","navigator","clipboard","writeText","copyColor","remote","screen","getPrimaryDisplay","id","size","setCanvas","canvas","ctx","backingStorePixelRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","pixelRatio","devicePixelRatio","scale","captureScreen","process","platform","desktopCapturer","getSources","types","thumbnailSize","then","sources","source","display_id","mediaDevices","getUserMedia","audio","video","mandatory","chromeMediaSource","chromeMediaSourceId","minWidth","maxWidth","minHeight","maxHeight","stream","handleStream","srcObject","onloadedmetadata","play","createImageBitmap","bmp","drawImage","getTracks","stop","ToolBar","ColorTip","captureRegionStyle","draggable","borderWidth","borderStyle","boxShadow","showColorTip","$data","globalCompositeOperation","posX","clientWidth","posY","clientHeight","el","isBeyondLeft","isBeyondBottom","Vue","use","BootstrapVue","IconsPlugin","productionTip","store","Store","screenWidth","screenHeight","theme","showMessage","savePath","app","getPath","playSound","captureColor","render","App","$mount"],"mappings":"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","file":"js/main.2c00f607.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"main\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([\"be94\",\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","module.exports = require(\"electron\");","module.exports = require(\"crypto\");","module.exports = require(\"assert\");","import mod from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/_css-loader@3.4.2@css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./ColorTip.vue?vue&type=style&index=0&id=70b686e7&lang=less&scoped=true&\"; export default mod; export * from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/_css-loader@3.4.2@css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./ColorTip.vue?vue&type=style&index=0&id=70b686e7&lang=less&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/feather.5a7f4448.svg\";","import mod from \"-!../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../node_modules/_css-loader@3.4.2@css-loader/dist/cjs.js??ref--10-oneOf-1-1!../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--10-oneOf-1-2!../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--10-oneOf-1-3!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../node_modules/_css-loader@3.4.2@css-loader/dist/cjs.js??ref--10-oneOf-1-1!../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--10-oneOf-1-2!../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--10-oneOf-1-3!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=less&\"","module.exports = require(\"util\");","module.exports = require(\"os\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","module.exports = require(\"worker_threads\");","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"layout\"}},[_c('div',{style:({cursor: _vm.completeSelectRegion? 'default':'crosshair'}),attrs:{\"id\":\"mask\"},on:{\"mousedown\":_vm.onSelectRegion}}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isCapture),expression:\"isCapture\"}],style:(_vm.captureRegionStyle),attrs:{\"id\":\"captureRegion\"}}),_c('canvas',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.completeSelectRegion),expression:\"completeSelectRegion\"}],ref:\"display\",style:({\n        position:'absolute',\n        left:_vm.canvasX+'px',\n        top:_vm.canvasY+'px',\n        zIndex:999,\n        pointerEvents:'none'}),attrs:{\"id\":\"display-canvas\"}}),_c('canvas',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.completeSelectRegion),expression:\"completeSelectRegion\"}],ref:\"assist\",style:({\n        position:'absolute',\n        left:_vm.canvasX+'px',\n        top:_vm.canvasY+'px',\n        zIndex:999,\n        cursor:'move'}),attrs:{\"id\":\"assist-canvas\"},on:{\"mousedown\":_vm.onDrag}}),_c('ToolBar',{directives:[{name:\"position\",rawName:\"v-position\",value:({x: _vm.x,y: _vm.y,width: _vm.width,height: _vm.height}),expression:\"{x,y,width,height}\"},{name:\"show\",rawName:\"v-show\",value:(_vm.completeSelectRegion),expression:\"completeSelectRegion\"}],attrs:{\"toolbarBottom\":_vm.toolbarBottom,\"canvasProps\":{canvasX: _vm.canvasX,canvasY: _vm.canvasY,canvasWidth: _vm.canvasWidth,canvasHeight: _vm.canvasHeight},\"clipDesktop\":_vm.clipDesktop},on:{\"initSelect\":function($event){return _vm.initSelect()},\"closeDrag\":function($event){_vm.canDrag=false}}}),(_vm.showColorTip)?_c('ColorTip',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isCapture),expression:\"!isCapture\"}]}):_vm._e(),_c('canvas',{ref:\"desktop\",style:({visibility: _vm.win32? 'hidden':'visible'}),attrs:{\"id\":\"desktop-canvas\"}}),_c('video',{attrs:{\"id\":\"video\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"toolbar\"}},[_c('b-button-group',{on:{\"click\":function($event){return _vm.$emit('closeDrag')}}},[_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"orchid-button\",\"title\":\"orchid\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"orchid-button\"}},[_c('span',[_vm._v(\"🌸\")])]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"undo-button\",\"title\":\"撤销\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"undo-button\"},on:{\"click\":_vm.clickUndo}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"reply-fill\",\"flip-h\":\"\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"redo-button\",\"title\":\"恢复\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"redo-button\"},on:{\"click\":_vm.clickRedo}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"reply-fill\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"square-button\",\"title\":\"矩形\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"square-button\"},on:{\"click\":_vm.clickSquare}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"square\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"circle-button\",\"title\":\"圆形\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"circle-button\"},on:{\"click\":_vm.clickCircle}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"circle\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"arrow-button\",\"title\":\"箭头\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"arrow-button\"},on:{\"click\":_vm.clickArrow}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"arrow-right\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"line-button\",\"title\":\"直线\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"line-button\"},on:{\"click\":_vm.clickLine}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"dash\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"text-button\",\"title\":\"文本\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"text-button\"},on:{\"click\":_vm.clickText}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"fonts\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"brush-button\",\"title\":\"涂鸦\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"brush-button\"},on:{\"click\":_vm.clickBrush}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"brush\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"lineshape-button\",\"title\":\"线型\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"lineshape-button\"}},[_c('span',{on:{\"click\":_vm.clickLineShape}},[_c('b-icon',{attrs:{\"icon\":\"list\"}})],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showLineShape),expression:\"showLineShape\"}],staticClass:\"lineshape-content\",style:({top:_vm.toolbarBottom>160? 40+'px':-143+'px'})},[_c('ul',{style:({background:_vm.themeDark? '#6c757d':'#fff'})},[_c('li',[_c('div',{style:(_vm.selectLineStyle)}),_c('p',{staticClass:\"line-width\"},[_vm._v(_vm._s(_vm.config.lineWidth+'px'))])]),_c('li',[_c('hr')]),_c('li',{attrs:{\"data-shape\":\"radius\"},on:{\"click\":_vm.changeLineShape}},[_c('div',{staticClass:\"radius-line\",style:({borderColor:_vm.themeDark? '#fff':'#000'})})]),_c('li',{attrs:{\"data-shape\":\"radius50\"},on:{\"click\":_vm.changeLineShape}},[_c('div',{staticClass:\"radius50-line\",style:({borderColor:_vm.themeDark? '#fff':'#000'})})]),_c('li',{attrs:{\"data-shape\":\"solid\"},on:{\"click\":_vm.changeLineShape}},[_c('div',{staticClass:\"solid-line\",style:({borderColor:_vm.themeDark? '#fff':'#000'})})]),_c('li',{attrs:{\"data-shape\":\"dashed\"},on:{\"click\":_vm.changeLineShape}},[_c('div',{staticClass:\"dash-line\",style:({borderColor:_vm.themeDark? '#fff':'#000'})})])]),_c('b-form-input',{staticClass:\"range-input\",attrs:{\"type\":\"range\",\"min\":\"0\",\"max\":\"40\",\"size\":\"sm\"},model:{value:(_vm.config.lineWidth),callback:function ($$v) {_vm.$set(_vm.config, \"lineWidth\", $$v)},expression:\"config.lineWidth\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"color-button\",\"title\":\"颜色\",\"custom-class\":\"tooltip\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"color-button\"}},[_c('span',{on:{\"click\":_vm.clickColor}},[_c('b-icon',{attrs:{\"icon\":\"pen\"}})],1),_c('ColorPicker',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showColorPicker),expression:\"showColorPicker\"}],style:({top:_vm.toolbarBottom>380? 40+'px':-345+'px',background:_vm.themeDark? '#6c757d':'#fff'}),attrs:{\"id\":\"colorpicker\",\"color\":_vm.config.lineColor},on:{\"changeColor\":_vm.changeColor}})],1),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"save-button\",\"title\":\"另存\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"save-button\"},on:{\"click\":_vm.clickSave}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"download\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"no-button\",\"title\":\"取消\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"no-button\"},on:{\"click\":_vm.clickNo}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"x\"}})],1)]),_c('b-tooltip',{attrs:{\"triggers\":\"focus\",\"target\":\"yes-button\",\"title\":\"确定\"}}),_c('b-button',{attrs:{\"variant\":_vm.themeDark? 'secondary':'light',\"id\":\"yes-button\"},on:{\"click\":_vm.clickYes}},[_c('span',[_c('b-icon',{attrs:{\"icon\":\"check\"}})],1)])],1),_c('audio',{ref:\"audio\",attrs:{\"src\":_vm.mp3path}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\n * 计算箭头坐标，需要鼠标mousedown坐标点(x1，y1）、鼠标移动坐标点(x2,y2)\n * 假设箭头(对称的一半)与直线夹角15*c，夹角两边长分别为l1=20,l2=10\n */\n\n export default (x1,y1,x2,y2)=>{\n   const  l1 = 20,l2=12,angle=Math.PI/12\n   //计算移动点与点击点之间的角度\n   const rotate = Math.atan2(y2-y1,x2-x1)\n   //计算箭头三个点的坐标，第四个点为鼠标移动点\n   const a1 = x2 - l1*Math.sin(Math.PI/2-rotate-angle)\n   const b1 = y2 - l1*Math.cos(Math.PI/2-rotate-angle)\n\n   const a2 = x2 - l2*Math.cos(rotate)\n   const b2 = y2 - l2*Math.sin(rotate)\n\n   const a3 = x2 - l1*Math.cos(rotate-angle)\n   const b3 = y2 - l1*Math.sin(rotate-angle)\n\n   return [a1,b1,a2,b2,a3,b3]\n }\n","<template>\r\n  <div id=\"toolbar\">\r\n    <!-- //点击工具按钮后，选区不可再移动 -->\r\n    <b-button-group @click=\"$emit('closeDrag')\">\r\n\r\n      <b-tooltip triggers='focus' target='orchid-button' title=\"orchid\"></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='orchid-button'>\r\n        <span>🌸</span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='undo-button' title=\"撤销\"></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='undo-button' @click=\"clickUndo\">\r\n        <span><b-icon icon=\"reply-fill\" flip-h></b-icon></span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='redo-button' title='恢复'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='redo-button' @click=\"clickRedo\">\r\n        <span><b-icon icon=\"reply-fill\"></b-icon></span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='square-button' title='矩形'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='square-button' @click=\"clickSquare\">\r\n        <span><b-icon icon=\"square\"></b-icon></span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='circle-button' title='圆形'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='circle-button' @click=\"clickCircle\">\r\n        <span><b-icon icon=\"circle\"></b-icon></span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='arrow-button' title='箭头'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='arrow-button' @click=\"clickArrow\">\r\n        <span><b-icon icon=\"arrow-right\"></b-icon></span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='line-button' title='直线'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='line-button' @click=\"clickLine\">\r\n        <span><b-icon icon=\"dash\"></b-icon></span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='text-button' title='文本'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='text-button' @click=\"clickText\">\r\n        <span><b-icon icon=\"fonts\"></b-icon></span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='brush-button' title='涂鸦'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='brush-button' @click=\"clickBrush\">\r\n        <span><b-icon icon=\"brush\"></b-icon></span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='lineshape-button' title='线型'></b-tooltip>\r\n      <!-- 框架的<b-dropdown/>组件存在无法更改背景色的bug，这里用原生写一个。 -->\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id=\"lineshape-button\">\r\n        <span @click=\"clickLineShape\"><b-icon icon=\"list\"></b-icon></span>\r\n        <div class='lineshape-content'\r\n          v-show=\"showLineShape\"\r\n          :style=\"{top:toolbarBottom>160? 40+'px':-143+'px'}\"\r\n        >\r\n        <ul :style=\"{background:themeDark? '#6c757d':'#fff'}\">\r\n          <li>\r\n            <div :style=\"selectLineStyle\"></div>\r\n            <p class='line-width'>{{config.lineWidth+'px'}}</p>\r\n          </li>\r\n          <li><hr/></li>\r\n          <li @click='changeLineShape' data-shape='radius'><div class='radius-line' :style=\"{borderColor:themeDark? '#fff':'#000'}\"></div></li>\r\n          <li @click='changeLineShape' data-shape='radius50'><div class='radius50-line' :style=\"{borderColor:themeDark? '#fff':'#000'}\"></div></li>\r\n          <li @click='changeLineShape' data-shape='solid'><div class='solid-line' :style=\"{borderColor:themeDark? '#fff':'#000'}\"></div></li>\r\n          <li @click='changeLineShape' data-shape='dashed'><div class='dash-line' :style=\"{borderColor:themeDark? '#fff':'#000'}\"></div></li>\r\n       </ul>\r\n        <b-form-input\r\n          class=\"range-input\"\r\n          type=\"range\"\r\n          min=\"0\"\r\n          max=\"40\"\r\n          size='sm'\r\n          v-model=\"config.lineWidth\"\r\n        ></b-form-input>\r\n       </div>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='color-button' title='颜色' custom-class='tooltip'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='color-button'>\r\n        <span @click=\"clickColor\"><b-icon icon=\"pen\"></b-icon></span>\r\n        <ColorPicker id='colorpicker'\r\n          v-show=\"showColorPicker\"\r\n          :style=\"{top:toolbarBottom>380? 40+'px':-345+'px',background:themeDark? '#6c757d':'#fff'}\"\r\n          :color=\"config.lineColor\"\r\n          @changeColor=\"changeColor\"\r\n        />\r\n      </b-button>\r\n\r\n      <!-- <b-tooltip triggers='focus' target='recognition-button' title='识别'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='recognition-button' @click=\"clickRecognition\">\r\n        <span><b-icon icon=\"camera\"></b-icon></span>\r\n      </b-button> -->\r\n\r\n      <b-tooltip triggers='focus' target='save-button' title=\"另存\"></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='save-button' @click=\"clickSave\">\r\n        <span><b-icon icon=\"download\"></b-icon></span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='no-button' title='取消'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='no-button' @click=\"clickNo\">\r\n        <span><b-icon icon=\"x\"></b-icon></span>\r\n      </b-button>\r\n\r\n      <b-tooltip triggers='focus' target='yes-button' title='确定'></b-tooltip>\r\n      <b-button :variant=\"themeDark? 'secondary':'light'\" id='yes-button' @click=\"clickYes\">\r\n        <span><b-icon icon=\"check\"></b-icon></span>\r\n      </b-button>\r\n\r\n    </b-button-group>\r\n    <audio :src=\"mp3path\" ref='audio'></audio>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport brush from '../assets/brush.svg'\r\nimport feather from '../assets/feather.svg'\r\n// import picker from '../assets/picker.svg'\r\nimport mp3 from '../assets/iphone.mp3'\r\n\r\nimport ColorPicker from '@caohenghu/vue-colorpicker'\r\nimport arrowCoordinate from '../utils/arrowCoordinate'\r\n\r\nimport { clipboard, nativeImage, remote, ipcRenderer } from 'electron'\r\nimport fs from 'fs'\r\nimport path from 'path'\r\n\r\n\r\nexport default {\r\n  props:{\r\n    toolbarBottom: Number,\r\n    canvasProps:Object,\r\n    clipDesktop:Function\r\n  },\r\n  components:{\r\n    ColorPicker\r\n  },\r\n  data() {\r\n    return {\r\n      showColorPicker:false,\r\n      showLineShape:false,\r\n      inputText:false,\r\n      fontSize:16,\r\n      themeDark:this.$root.$data.theme==='dark',\r\n\r\n      featherCursor:`url(${feather}) 0 30,default`,\r\n      brushCursor: `url(${brush}) 0 30,default`,\r\n      // pickerCursor:`url(${picker}) 0 30,default`,\r\n      mp3path:mp3,\r\n\r\n      config:{\r\n        lineWidth:2,\r\n        lineColor:\"#6EFF2A\",\r\n        lineCap:'round',\r\n        lineDash:[0,0],\r\n        // shadowBlur:2,\r\n        lineRadius50:false,\r\n        //选项显示用\r\n        lineShape:'solid',\r\n        radius:'0px'\r\n      },\r\n\r\n      recordsQueue:[0],\r\n\r\n    }\r\n  },\r\n  computed:{\r\n    selectLineStyle(){\r\n      return {\r\n        width:'100px',\r\n        height:'0px',\r\n        border: 'none',\r\n        borderBottom:this.config.lineWidth+'px ' + this.config.lineColor + ' ' + this.config.lineShape,\r\n        borderRadius:this.config.radius\r\n      }\r\n    },\r\n    canvasX(){\r\n      return this.canvasProps.canvasX\r\n    },\r\n    canvasY(){\r\n      return this.canvasProps.canvasY\r\n    },\r\n    canvasWidth(){\r\n      return this.canvasProps.canvasWidth\r\n    },\r\n    canvasHeight(){\r\n      return this.canvasProps.canvasHeight\r\n    },\r\n  },\r\n  mounted(){\r\n    this.displayRef = document.getElementById('display-canvas')\r\n    this.displayCtx = this.displayRef.getContext('2d')\r\n\r\n    this.assistRef = document.getElementById('assist-canvas')\r\n    this.assistCtx = this.assistRef.getContext('2d')\r\n\r\n    //----ESC\r\n    ipcRenderer.on('pressESC',()=>this.clickNo())\r\n  },\r\n  methods: {\r\n    changeColor(color) {\r\n      const { r, g, b, a } = color.rgba\r\n      this.config.lineColor = `rgba(${r}, ${g}, ${b}, ${a})`\r\n    },\r\n    changeLineShape(e){\r\n      this.config.lineRadius50 = false\r\n      let shape = e.target.dataset.shape\r\n\r\n      switch(shape){\r\n        case 'solid':\r\n          this.config.lineCap='butt'\r\n          this.config.lineShape = 'solid'\r\n          this.config.radius = '0px'\r\n          this.config.lineDash = [0,0]\r\n          break\r\n        case 'radius':\r\n          this.config.lineCap = 'round'\r\n          this.config.lineShape = 'solid'\r\n          this.config.radius = this.config.lineWidth/2+'px'\r\n          this.config.lineDash = [0,0]\r\n          break\r\n        case 'radius50':\r\n          this.config.lineRadius50 = true\r\n          this.config.lineShape = 'solid'\r\n          this.config.radius = '50%'\r\n          this.config.lineDash = [0,0]\r\n          this.clickLine() //小bug，点击了会关闭下拉框，且和clickCircle相互影响\r\n          break\r\n        case 'dashed':\r\n          this.config.lineDash = [12,10]\r\n          this.config.lineShape = 'dashed'\r\n          this.config.radius = '0px'\r\n          break\r\n      }\r\n    },\r\n    colseDropDown(){\r\n      this.showColorPicker = this.showLineShape = false\r\n    },\r\n    clickUndo(){\r\n      this.colseDropDown()\r\n      let currentData = this.recordsQueue.pop()\r\n      if(currentData){\r\n        this.recordsQueue.unshift(currentData)\r\n        let preData = this.recordsQueue[this.recordsQueue.length-1]\r\n        if(preData){ //!==0\r\n          this.displayCtx.putImageData(preData,0,0) //恢复前一次状态\r\n        } else { //===0\r\n          this.clipDesktop()\r\n        }\r\n      }else{\r\n        this.recordsQueue.push(currentData) //0\r\n      }\r\n    },\r\n    clickRedo(){\r\n      this.colseDropDown()\r\n\r\n      let nextData = this.recordsQueue.shift()\r\n      if(nextData){\r\n        this.displayCtx.putImageData(nextData,0,0)\r\n        this.recordsQueue.push(nextData)\r\n      }else{\r\n        this.recordsQueue.unshift(nextData) //0\r\n      }\r\n    },\r\n    recordAndClearEvents(){\r\n      let currentData = this.displayCtx.getImageData(0,0,this.canvasWidth,this.canvasHeight)\r\n      this.recordsQueue.push(currentData)\r\n\r\n      document.onmousemove = null\r\n      document.onmouseup = null\r\n    },\r\n    setStyle(){\r\n      this.displayCtx.lineWidth = this.config.lineWidth\r\n      this.displayCtx.strokeStyle = this.config.lineColor\r\n      this.displayCtx.shadowColor = this.config.lineColor\r\n      // this.displayCtx.shadowBlur = this.config.shadowBlur\r\n      this.displayCtx.lineCap = this.config.lineCap\r\n      this.displayCtx.setLineDash(this.config.lineDash)\r\n\r\n      this.assistCtx.lineWidth = this.config.lineWidth\r\n      this.assistCtx.strokeStyle = this.config.lineColor\r\n      this.assistCtx.shadowColor = this.config.lineColor\r\n      // this.assistCtx.shadowBlur = this.config.shadowBlur\r\n      this.assistCtx.lineCap = this.config.lineCap\r\n      this.assistCtx.setLineDash(this.config.lineDash)\r\n    },\r\n    clickSquare(){\r\n      this.colseDropDown()\r\n      this.assistRef.style.cursor = \"crosshair\"\r\n\r\n      this.assistRef.onmousedown = e => {\r\n        let x1 = e.clientX,\r\n            y1 = e.clientY,\r\n            left = this.canvasX,\r\n            top = this.canvasY,\r\n            X = x1-left, //相对于画布，起点X\r\n            Y = y1-top //相对于画布，起点Y\r\n        //设置样式\r\n        this.setStyle()\r\n        //开始绘制\r\n        // this.assistCtx.beginPath()\r\n        this.assistCtx.moveTo(X,Y)\r\n\r\n        //bind mousemove\r\n        let x2,y2\r\n        document.onmousemove = e => {\r\n          x2 = e.clientX\r\n          y2 = e.clientY\r\n\r\n          this.assistCtx.clearRect(0,0,this.canvasWidth,this.canvasHeight)\r\n          this.assistCtx.beginPath()\r\n          this.assistCtx.rect(X,Y,x2-x1,y2-y1)\r\n          this.assistCtx.stroke()\r\n        }\r\n\r\n        document.onmouseup = () => {\r\n          //清空辅助画布并绘制到显示画布\r\n          this.assistCtx.clearRect(0,0,this.canvasWidth,this.canvasHeight)\r\n          this.displayCtx.strokeRect(X,Y,x2-x1,y2-y1)\r\n          //记录当前的状态并清理事件\r\n          this.recordAndClearEvents()\r\n          //------\r\n        }\r\n      }\r\n    },\r\n    clickCircle(){ //椭圆也可以用贝赛尔曲线绘制\r\n      this.colseDropDown()\r\n      this.assistRef.style.cursor = this.config.lineRadius50 ? this.featherCursor:'crosshair'\r\n\r\n      this.assistRef.onmousedown = e => {\r\n        let x1 = e.clientX,\r\n            y1 = e.clientY,\r\n            left = this.canvasX,\r\n            top = this.canvasY,\r\n            X = x1-left, //相对于画布，起点X\r\n            Y = y1-top //相对于画布，起点Y\r\n        //设置样式\r\n        this.setStyle()\r\n        //开始绘制\r\n        // this.assistCtx.beginPath()\r\n        this.assistCtx.moveTo(X,Y)\r\n\r\n        //bind mousemove\r\n        let w,h\r\n        document.onmousemove = e => {\r\n          w = e.clientX - x1\r\n          h = e.clientY - y1\r\n\r\n          this.assistCtx.clearRect(0,0,this.canvasWidth,this.canvasHeight)\r\n          this.assistCtx.beginPath()\r\n          if(this.config.lineRadius50){//模拟radius50%直线\r\n            this.assistCtx.ellipse(X+w/2,Y+h/2,Math.abs(w/2),this.config.lineWidth/2,0, 0, 2 * Math.PI)\r\n          }else{\r\n            this.assistCtx.ellipse(X+w/2,Y+h/2,Math.abs(w/2),Math.abs(h/2),0, 0, 2 * Math.PI) //centerx,centery,long radius,short radius,start angle,end angle\r\n          }\r\n          this.assistCtx.stroke()\r\n        }\r\n\r\n        document.onmouseup = () => {\r\n          //清空辅助画布，绘制到显示画布\r\n          this.assistCtx.clearRect(0,0,this.canvasWidth,this.canvasHeight)\r\n\r\n          this.displayCtx.beginPath()\r\n          if(this.config.lineRadius50){ //模拟radius50%直线\r\n            this.displayCtx.ellipse(X+w/2,Y+h/2,Math.abs(w/2),this.config.lineWidth/2,0, 0, 2 * Math.PI)\r\n          }else{\r\n            this.displayCtx.ellipse(X+w/2,Y+h/2,Math.abs(w/2),Math.abs(h/2),0, 0, 2 * Math.PI)\r\n          }\r\n          this.displayCtx.stroke()\r\n\r\n          //记录当前的状态并清理事件\r\n          this.recordAndClearEvents()\r\n          //------\r\n        }\r\n      }\r\n    },\r\n    clickArrow(){\r\n      this.colseDropDown()\r\n      this.assistRef.style.cursor = this.featherCursor\r\n\r\n      this.assistRef.onmousedown = e =>{\r\n        let x1 = e.clientX,\r\n            y1 = e.clientY,\r\n            left = this.canvasX,\r\n            top = this.canvasY,\r\n            X = x1-left,\r\n            Y = y1-top\r\n        //设置样式\r\n        this.setStyle()\r\n\r\n        //绘制过程\r\n        let X2,Y2,a1,b1,a2,b2,a3,b3\r\n        document.onmousemove = e => {\r\n          X2 = e.clientX - left;\r\n          Y2 = e.clientY - top;\r\n\r\n          //获得箭头的坐标点\r\n          [a1,b1,a2,b2,a3,b3] = arrowCoordinate(X,Y,X2,Y2)\r\n          this.assistCtx.clearRect(0,0,this.canvasWidth,this.canvasHeight) //这行不要可以绘制散射线\r\n          this.assistCtx.beginPath()\r\n          this.assistCtx.moveTo(X,Y)\r\n          this.assistCtx.lineTo(X2,Y2)\r\n          this.assistCtx.moveTo(a2,b2)\r\n          this.assistCtx.lineTo(a1,b1)\r\n          this.assistCtx.lineTo(X2,Y2)\r\n          this.assistCtx.lineTo(a3,b3)\r\n          this.assistCtx.lineTo(a2,b2)\r\n          this.assistCtx.stroke()\r\n        }\r\n        document.onmouseup = () => {\r\n          //清空辅助画布并绘制到显示画布\r\n          this.assistCtx.clearRect(0,0,this.canvasWidth,this.canvasHeight)\r\n          this.displayCtx.beginPath()\r\n          this.displayCtx.moveTo(X,Y)\r\n          this.displayCtx.lineTo(X2,Y2)\r\n          this.displayCtx.moveTo(a2,b2)\r\n          this.displayCtx.lineTo(a1,b1)\r\n          this.displayCtx.lineTo(X2,Y2)\r\n          this.displayCtx.lineTo(a3,b3)\r\n          this.displayCtx.lineTo(a2,b2)\r\n          this.displayCtx.stroke()\r\n\r\n          //记录当前的状态并清理事件\r\n          this.recordAndClearEvents()\r\n          //------\r\n        }\r\n      }\r\n    },\r\n    clickLine(){\r\n      // this.colseDropDown()\r\n      this.assistRef.style.cursor = this.featherCursor\r\n      if(this.config.lineRadius50){\r\n        this.clickCircle()\r\n        return\r\n      }\r\n      this.assistRef.onmousedown = e =>{\r\n        let x1 = e.clientX,\r\n            y1 = e.clientY,\r\n            left = this.canvasX,\r\n            top = this.canvasY,\r\n            X = x1-left,\r\n            Y = y1-top\r\n        //设置样式\r\n        this.setStyle()\r\n\r\n        //绘制过程\r\n        let X2,Y2\r\n        document.onmousemove = e => {\r\n          X2 = e.clientX - left\r\n          Y2 = e.clientY - top\r\n\r\n          this.assistCtx.clearRect(0,0,this.canvasWidth,this.canvasHeight) //这行不要可以绘制散射线\r\n          this.assistCtx.beginPath()\r\n          this.assistCtx.moveTo(X,Y)\r\n          this.assistCtx.lineTo(X2,Y2)\r\n          this.assistCtx.stroke()\r\n        }\r\n        document.onmouseup = () => {\r\n          //清空辅助画布并绘制到显示画布\r\n          this.assistCtx.clearRect(0,0,this.canvasWidth,this.canvasHeight)\r\n          this.displayCtx.beginPath()\r\n          this.displayCtx.moveTo(X,Y)\r\n          this.displayCtx.lineTo(X2,Y2)\r\n          this.displayCtx.stroke()\r\n\r\n          //记录当前的状态并清理事件\r\n          this.recordAndClearEvents()\r\n          //------\r\n        }\r\n      }\r\n    },\r\n    clickText(){\r\n      this.colseDropDown()\r\n      this.assistRef.style.cursor = \"text\"\r\n      this.inputText = true\r\n\r\n      this.assistRef.onmousedown = (e) => {\r\n        let x = e.clientX,y=e.clientY\r\n        const textInput = document.createElement('div')\r\n        textInput.className = 'textInput'\r\n        textInput.contentEditable = true\r\n        textInput.style.position = 'absolute'\r\n        textInput.style.left = x + 'px'\r\n        textInput.style.top = y + 'px'\r\n        textInput.style.zIndex = 9999\r\n        textInput.style.color = this.config.lineColor\r\n        textInput.style.padding = '5px'\r\n        textInput.style.lineHeight = this.fontSize + 'px'\r\n        textInput.style.fontSize = this.fontSize + 'px'\r\n        textInput.style.fontFamily = 'Microsoft YaHei,Sans Serif,System UI'\r\n        textInput.style.cursor = 'text'\r\n        textInput.onblur = this.textInputBlur\r\n        textInput.onkeydown = this.textInputKeyDown\r\n        this.$root.$el.appendChild(textInput)\r\n\r\n        document.onmousemove = e => {\r\n            textInput.style.width =  e.clientX - x + \"px\";\r\n            textInput.style.height =  e.clientY - y + \"px\";\r\n        }\r\n        document.onmouseup = () => {\r\n          textInput.focus()\r\n          document.onmousemove = null;\r\n          this.assistRef.onmousedown = null\r\n        }\r\n      }\r\n    },\r\n    clickBrush(){\r\n      this.colseDropDown()\r\n      this.assistRef.style.cursor = this.brushCursor\r\n\r\n      this.assistRef.onmousedown = e =>{\r\n        let x1 = e.clientX,\r\n            y1 = e.clientY,\r\n            left = this.canvasX,\r\n            top = this.canvasY,\r\n            X = x1-left,\r\n            Y = y1-top\r\n        //设置样式\r\n        this.setStyle()\r\n        //开始绘制\r\n        // this.displayCtx.beginPath()\r\n        this.displayCtx.moveTo(X,Y)\r\n        //绘制过程\r\n        document.onmousemove = e => {\r\n          let x2 = e.clientX,\r\n              y2 = e.clientY,\r\n              X2 = x2 - left,\r\n              Y2 = y2 - top\r\n          this.displayCtx.lineTo(X2,Y2)\r\n          this.displayCtx.stroke()\r\n        }\r\n      document.onmouseup = () => {\r\n        //记录当前的状态\r\n        let currentData = this.displayCtx.getImageData(0,0,this.canvasWidth,this.canvasHeight)\r\n        this.recordsQueue.push(currentData)\r\n\r\n        //记录当前的状态并清理事件\r\n        this.recordAndClearEvents()\r\n        //------\r\n      }\r\n      }\r\n    },\r\n    clickLineShape(){\r\n      this.showColorPicker = false\r\n      this.showLineShape = !this.showLineShape\r\n    },\r\n    clickColor(){\r\n      this.showLineShape = false\r\n      this.showColorPicker = !this.showColorPicker\r\n    },\r\n    // clickRecognition(){\r\n    //   this.colseDropDown()\r\n    // },\r\n    clickSave(){\r\n      remote.dialog.showSaveDialog(\r\n        {\r\n          title:'图片另存为',\r\n          defaultPath:this.$root.$data.savePath,\r\n          filters:[\r\n            {'name':'*.png',extensions:['png']},\r\n            {'name':'*.jpeg',extensions:['jpeg']},\r\n          ],\r\n          nameFieldLabel: new Date().toLocaleTimeString()\r\n        }\r\n      ).then(res=>{\r\n        const { ext } = path.parse(res.filePath)\r\n        let url = this.displayRef.toDataURL('image/png')\r\n        if (ext==='.jpeg'|| ext==='.jpg'){\r\n          url = this.displayRef.toDataURL('image/jpeg',1)\r\n        }\r\n        const imageData= url.replace(/^data:image\\/\\w+;base64,/, \"\");\r\n        const imageBuffer = new Buffer(imageData, 'base64')\r\n        // fs.writeFile(res.filePath, imageBuffer)\r\n        const writeStream = fs.createWriteStream(res.filePath,{encoding:'utf8',autoClose:true})\r\n        writeStream.write(imageBuffer)\r\n        writeStream.on('error',err=>{\r\n          if(err) throw err\r\n          if(this.$root.$data.showMessage){\r\n            let errNotification = new Notification(\r\n              '保存失败,您可能取消了操作',\r\n              { silent:true }\r\n            )\r\n            setTimeout(()=>{\r\n              errNotification.close()\r\n            },1500)\r\n          }\r\n          return\r\n        })\r\n      })\r\n    },\r\n    clickNo() {\r\n      //关闭下拉框\r\n      this.colseDropDown()\r\n      //初始化选择区域状态\r\n      this.$emit('initSelect')\r\n      //改变为适合的cursor,并清理mousedown事件\r\n      this.assistRef.style.cursor = 'move'\r\n      this.assistRef.onmousedown = null //一定要清理掉，否则再次截图会无法拖拽，直接触发上次的mousedown事件\r\n      //清空画布\r\n      this.recordsQueue = [0]\r\n      this.displayCtx.clearRect(0,0,this.canvasWidth,this.canvasHeight)\r\n      //清空文本框\r\n      const textInputs = document.getElementsByClassName('textInput')\r\n      textInputs.forEach(div=>this.$root.$el.removeChild(div))\r\n    },\r\n    clickYes(){\r\n      const {showMessage,playSound} = this.$root.$data\r\n      // 复制到clipboard\r\n      // let url = this.displayRef.toDataURL('image/jpeg',1)\r\n      // let url = document.getElementById('desktop-canvas').toDataURL('image/png')\r\n      let url = this.displayRef.toDataURL('image/png')\r\n\r\n      let image = nativeImage.createFromDataURL(url)\r\n      clipboard.writeImage(image)\r\n      if(playSound) this.$refs.audio.play()\r\n      //显示通知\r\n      if(showMessage){\r\n        let notification = new Notification('', {\r\n          body: '已复制到剪贴板',\r\n          silent:true,\r\n          icon:url\r\n        })\r\n        setTimeout(()=>{\r\n          notification.close()\r\n        },1500)\r\n      }\r\n\r\n      //-----------\r\n      this.clickNo()\r\n      //最小化/隐藏窗口\r\n      remote.getCurrentWindow().minimize()\r\n      // remote.getCurrentWindow().hide()\r\n    },\r\n    textInputBlur(e){\r\n      if(!e.target.textContent) return\r\n\r\n      //暂未实现改变字体大小,用文本编辑器又没多大必要\r\n      let x = parseInt(e.target.style.left)-this.canvasX + 5  // padding 5px\r\n      let y = parseInt(e.target.style.top)-this.canvasY + 5  //\r\n      let divWidth = parseInt(e.target.style.width)\r\n      let text = e.target.innerHTML+`<div><br></div>`  //like: 'afaf<div><br></div><div>gagdfgsdfg</div><div>hdfhh</div>'\r\n\r\n      let rows = []\r\n      text.split('<div>').forEach(row => (\r\n        rows.push(row.replace(/<\\/div>/g,'').replace(/<br>/g,'').replace(/&nbsp;/g,''))\r\n        )\r\n      )\r\n\r\n      let totalLength = this.displayCtx.measureText(rows[0]).width //第一行\r\n      let n = Math.ceil(totalLength/divWidth) //回车之前的文字行数\r\n      let words = Math.ceil((divWidth-10-4)/(this.fontSize+4)) //一行大约多少字符,width:padding 5 border 2 / 字体宽度+间距\r\n\r\n      this.displayCtx.font = `${this.fontSize}px 黑体,Microsoft YaHei,Sans Serif,System UI`\r\n      // this.displayCtx.strokeStyle = this.config.lineColor\r\n      this.displayCtx.fillStyle = this.config.lineColor\r\n      this.displayCtx.lineWidth = this.config.lineWidth\r\n      let lineGap = 1 //\r\n      rows.forEach((row,index)=>{\r\n        if(index===0){\r\n          for(let i=0;i<n;i++){\r\n            let txt = ''\r\n            for(let j in row){\r\n              if(j>=i*words && j< (i+1)*words){\r\n                txt+=row[j]\r\n              }\r\n            }\r\n            // this.displayCtx.strokeText(txt,x,y+(this.fontSize+lineGap)*i)\r\n            this.displayCtx.fillText(txt,x,y+(this.fontSize+lineGap)*i)\r\n            txt = ''\r\n          }\r\n        }else{\r\n          // this.displayCtx.strokeText(row,x,y+(this.fontSize+lineGap)*(n+index))\r\n          this.displayCtx.fillText(row,x,y+(this.fontSize+lineGap)*(n+index))\r\n        }\r\n      })\r\n\r\n      //移除dom元素\r\n      this.$root.$el.removeChild(e.target)\r\n      //记录当前状态\r\n      let currentData = this.displayCtx.getImageData(0,0,this.canvasWidth,this.canvasHeight)\r\n      this.recordsQueue.push(currentData)\r\n    },\r\n    textInputKeyDown(e){\r\n      if((e.target.innerHTML==='' && e.keyCode===8)){ //backspace\r\n        this.$root.$el.removeChild(e.target)\r\n      }\r\n      if(e.keyCode===46){ //del\r\n        e.target.innerHTML = ''\r\n        this.$root.$el.removeChild(e.target)\r\n      }\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang='less' scoped>\r\n#toolbar{\r\n  z-index: 999;\r\n  .btn-group {\r\n    button {\r\n      padding: 5px 9px 7px 9px;\r\n      margin:0px;\r\n      span {\r\n        display: inline-block;\r\n        transform: scale(1.5);\r\n        &:hover{\r\n          transform: scale(1.8);\r\n          transition: all 0.3s;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n#colorpicker{\r\n  z-index: 9999;\r\n  position: absolute;\r\n  left:-55px;\r\n  background: #6c757d;\r\n  width: 220px !important;\r\n}\r\n\r\n.tooltip{\r\n  z-index: -1;\r\n}\r\n\r\n#lineshape-button{\r\n  .lineshape-content{\r\n    position:absolute;\r\n    // top:40px;\r\n    left:-30px;\r\n    ul{\r\n      background: #6c757d;\r\n      list-style: none;\r\n      padding: 0px;\r\n      width:150px;\r\n      height: 10%;\r\n      min-height: 140px;\r\n      li{\r\n        padding: 10px;\r\n        &:nth-child(1){\r\n          padding-top: 20px;\r\n        }\r\n        &:nth-child(2){\r\n          padding: 0px;\r\n          hr{\r\n            margin: 0px;\r\n            width:75%;\r\n          }\r\n        }\r\n      }\r\n      .radius-line{\r\n        width:100px;\r\n        height: 0px;\r\n        border:none;\r\n        border-bottom:6px #fff solid;\r\n        border-radius: 3px;\r\n      }\r\n      .radius50-line{\r\n        width:100px;\r\n        height: 0px;\r\n        border:none;\r\n        border-bottom:6px #fff solid;\r\n        border-radius: 50%;\r\n      }\r\n      .solid-line{\r\n        width:100px;\r\n        height: 0px;\r\n        border: none;\r\n        border-bottom:6px #fff solid;\r\n      }\r\n      .dash-line{\r\n        width:100px;\r\n        height: 0px;\r\n        border:none;\r\n        border-bottom:3px #fff dashed;\r\n      }\r\n    }\r\n\r\n\r\n    //\r\n    .line-width{\r\n      position: absolute;\r\n      top:6%;\r\n      right:2%;\r\n      font-size: 14px;\r\n    }\r\n    .range-input{\r\n      position: absolute;\r\n      transform: rotate(90deg);\r\n      top:48%;\r\n      left:55%;\r\n      width:65%;\r\n    }\r\n  }\r\n}\r\n\r\n</style>\r\n","import mod from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./ToolBar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./ToolBar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ToolBar.vue?vue&type=template&id=8baa6ef8&scoped=true&\"\nimport script from \"./ToolBar.vue?vue&type=script&lang=js&\"\nexport * from \"./ToolBar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ToolBar.vue?vue&type=style&index=0&id=8baa6ef8&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8baa6ef8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"colortip\"}},[_c('div',{style:(_vm.tipboardStyle),attrs:{\"id\":\"tipboard\"}},[_c('ul',[_c('li',[_c('span',[_vm._v(\"x :\")]),_vm._v(_vm._s(_vm.left)+\" \"),_c('span',{staticStyle:{\"padding-left\":\"20px\"}},[_vm._v(\"y :\")]),_vm._v(_vm._s(_vm.top)+\" \")]),_c('li',[_c('span',{style:({textDecoration:_vm.switchColor? 'none':'underline rgba(241,90,39,255)'})},[_vm._v(\"hex :\")]),_c('span',{style:({color:_vm.hex})},[_vm._v(_vm._s(_vm.hex))])]),_c('li',[_c('span',{style:({textDecoration:_vm.switchColor? 'underline rgba(241,90,39,255)':'none'})},[_vm._v(\"rgba:\")]),_c('span',{style:({color:'rgba'+ _vm.rgba})},[_vm._v(_vm._s(_vm.rgba))])]),_c('li',[_c('span',[_vm._v(\"按c复制 shift切换\")]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.hasCopy),expression:\"hasCopy\"}]},[_vm._v(\"已复制\")])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const RGB2Hex = (color)=>{\n  let values = color\n    .replace(/rgba?\\(/, '')\n    .replace(/\\)/, '')\n    .replace(/[\\s+]/g, '')\n    .split(',');\n  let a = parseFloat(values[3] || 1),\n      r = Math.floor(a * parseInt(values[0]) + (1 - a) * 255),\n      g = Math.floor(a * parseInt(values[1]) + (1 - a) * 255),\n      b = Math.floor(a * parseInt(values[2]) + (1 - a) * 255);\n  return \"#\" +\n    (\"0\" + r.toString(16)).slice(-2) +\n    (\"0\" + g.toString(16)).slice(-2) +\n    (\"0\" + b.toString(16)).slice(-2);\n}\n\nexport default RGB2Hex\n","<template>\n  <div id='colortip'>\n    <div id=\"tipboard\" :style=\"tipboardStyle\">\n      <ul>\n        <li>\n          <span>x :</span>{{left}}\n          <span style=\"padding-left:20px\">y :</span>{{top}}\n        </li>\n        <li >\n          <span :style=\"{textDecoration:switchColor? 'none':'underline rgba(241,90,39,255)'}\">hex :</span>\n          <span :style='{color:hex}'>{{hex}}</span>\n        </li>\n        <li>\n          <span :style=\"{textDecoration:switchColor? 'underline rgba(241,90,39,255)':'none'}\">rgba:</span>\n          <span :style=\"{color:'rgba'+ rgba}\">{{rgba}}</span>\n        </li>\n        <li>\n          <span>按c复制 shift切换</span>\n          <span v-show=\"hasCopy\">已复制</span>\n        </li>\n      </ul>\n    </div>\n  </div>\n</template>\n\n<script>\nimport RGB2HEX from '../utils/RGB2HEX'\n\nexport default {\n  data(){\n    return {\n      left:0,\n      top:0,\n      hex:'#000000',\n      rgba:'(0,0,0,0)',\n      switchColor:false,\n      hasCopy:false,\n      themeDark:this.$root.$data.theme==='dark'\n    }\n  },\n  computed:{\n    tipboardStyle(){\n      let top,left\n      if(this.left>180){\n        top = this.top - 50 + 'px'\n        left = this.left - 220 + 'px'\n      }else{\n        left = this.left + 30 + 'px'\n        top = this.top-50 +'px'\n      }\n      let background = this.themeDark? \"#6c757d\":\"#fff\"\n      let color = this.themeDark? \"#fff\":'#6c757d'\n      return {\n        position:'absolute',\n        border: `2px ${this.hex} dashed`,\n        background,\n        color,\n        left,\n        top\n      }\n    }\n  },\n  mounted(){\n    //获得实时像素\n    const mask = document.getElementById('mask')\n    const desktopCanvas = document.getElementById('desktop-canvas')\n    let desktopCtx = desktopCanvas.getContext('2d')\n\n    mask.onmousemove = e =>{\n      this.left = e.clientX\n      this.top = e.clientY\n      let pixel = desktopCtx.getImageData(this.left,this.top,1,1)\n      let r = pixel.data[0],\n          g = pixel.data[1],\n          b = pixel.data[2],\n          a = pixel.data[3]\n      this.rgba = `(${r},${g},${b},${a})`\n      this.hex = RGB2HEX('rgba'+this.rgba)\n    }\n\n    //绑定复制颜色事件\n    document.onkeydown = e => {\n      if(this.isCapture){\n        return false\n      }\n      if(e.keyCode===16){\n        this.switchColor = !this.switchColor\n      }\n      if(e.keyCode===67){ //按C复制\n        this.hasCopy = true\n        let copyColor = this.switchColor? 'rgba'+this.rgba:this.hex\n        navigator.clipboard.writeText(copyColor)\n\n        setTimeout(() => {\n          if(this.hasCopy){\n            this.hasCopy = false\n          }\n        }, 2000);\n      }\n    }\n  }\n}\n</script>\n\n<style lang='less' scoped>\n#colortip{\n  pointer-events: none;\n  #tipboard{\n    z-index: 1;\n    background:#6c757d;\n    color: #fff;\n    border:1px #fff dashed;\n    ul{\n      list-style: none;\n      padding: 5px;\n      margin: 0px;\n      z-index: 0;\n      li{\n        span:nth-child(1){\n          padding-right: 5px;\n          font-weight: bold;\n        }\n      }\n      li:last-child{\n        font-size:11px;\n        padding-top: 5px;\n        span:nth-child(2){\n          font-weight: bold;\n          color: rgba(241,90,39,255);\n          padding-left:10px\n        }\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./ColorTip.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./ColorTip.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ColorTip.vue?vue&type=template&id=70b686e7&scoped=true&\"\nimport script from \"./ColorTip.vue?vue&type=script&lang=js&\"\nexport * from \"./ColorTip.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ColorTip.vue?vue&type=style&index=0&id=70b686e7&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"70b686e7\",\n  null\n  \n)\n\nexport default component.exports","import { remote,desktopCapturer } from 'electron'\r\n\r\nconst { id,size } = remote.screen.getPrimaryDisplay() //workAreaSize >= size,前者包含屏幕左右的黑边框\r\n\r\n//解决canvas渲染模糊\r\n export const setCanvas = (canvas,width,height)=>{\r\n  let ctx = canvas.getContext('2d')\r\n  let backingStorePixelRatio = ctx.backingStorePixelRatio ||\r\n  ctx.webkitBackingStorePixelRatio ||\r\n  ctx.mozBackingStorePixelRatio ||\r\n  ctx.msBackingStorePixelRatio ||\r\n  ctx.oBackingStorePixelRatio ||\r\n  ctx.backingStorePixelRatio || 1\r\n\r\n  const pixelRatio = (window.devicePixelRatio || 1)/backingStorePixelRatio //获得屏幕像素比，进行缩放，否则绘制会出现模糊\r\n  canvas.width = width * pixelRatio //相应缩放画布\r\n  canvas.height = height * pixelRatio\r\n  ctx.scale(pixelRatio,pixelRatio)\r\n\r\n  canvas.style.width = width + 'px'//实际按照屏幕大小绘制\r\n  canvas.style.height = height +'px'\r\n\r\n  return ctx\r\n}\r\n\r\n\r\nexport const captureScreen = () => {\r\n  if(process.platform==='win32'){ //老坑：desktopCapture=>linux下无效\r\n    desktopCapturer.getSources(\r\n      { types: ['screen'],thumbnailSize:{width:0,height:0}}\r\n    ).then(async sources => {\r\n      for (let source of sources) {\r\n        // console.log(typeof source.display_id) //坑\r\n        // console.log(typeof id) //坑\r\n        if (source.display_id === id.toString()) {\r\n          const stream = await navigator.mediaDevices.getUserMedia({\r\n            audio: false,\r\n            video: {\r\n              mandatory: {\r\n                chromeMediaSource: 'desktop',\r\n                chromeMediaSourceId: source.id,\r\n                minWidth: size.width,\r\n                maxWidth: size.width,\r\n                minHeight: size.height,\r\n                maxHeight: size.height\r\n              }\r\n            }\r\n          })\r\n          handleStream(stream)\r\n        }\r\n      }\r\n    })\r\n\r\n   } else { //linux\r\n     navigator.mediaDevices.getUserMedia({\r\n       audio: false,\r\n       video: {\r\n         mandatory: {\r\n           chromeMediaSource: 'desktop',\r\n           // chromeMediaSourceId: source.id, //出现NotReadableError,是因为getPrimaryDisplay()返回的id不一致，不做多屏幕直接去掉就可以了\r\n           minWidth: size.width,\r\n           maxWidth: size.width,\r\n           minHeight: size.height,\r\n           maxHeight: size.height,\r\n         },\r\n       }\r\n     }).then( stream => handleStream(stream))\r\n   }\r\n}\r\n\r\n\r\nconst handleStream = (stream) => {\r\n  const video = document.getElementById('video')\r\n  video.srcObject = stream\r\n  video.onloadedmetadata = () => {\r\n    video.play()\r\n\r\n    let canvas = document.getElementById('desktop-canvas')\r\n    canvas.width = size.width\r\n    canvas.height = size.height\r\n    canvas.style.width = size.width+'px'//实际按照屏幕大小绘制\r\n    canvas.style.height = size.height+'px'\r\n\r\n    const ctx = canvas.getContext('2d')\r\n\r\n    // ctx.drawImage(video,0, 0)\r\n    ctx.clearRect(0,0,size.width,size.height)\r\n    createImageBitmap(video).then(bmp => { //转为bitmap，可以提高性能，降低canvas渲染延迟\r\n      // ctx.imageSmoothingEnabled = false;\r\n      ctx.drawImage(bmp, 0, 0) //startX,startY,width,height  in canvas\r\n      stream.getTracks()[0].stop() //关闭视频流，序号是反向的，此处只有一个所以是0\r\n      // 移除video元素\r\n//      document.getElementById('layout').removeChild(video)\r\n    })\r\n  }\r\n}\r\n","<template>\r\n  <div id=\"layout\">\r\n    <div id=\"mask\"\r\n      @mousedown=\"onSelectRegion\"\r\n      :style=\"{cursor: completeSelectRegion? 'default':'crosshair'}\">\r\n    </div>\r\n\r\n<!-- caputure region -->\r\n    <div id=\"captureRegion\"\r\n      :style=\"captureRegionStyle\"\r\n      v-show=\"isCapture\">\r\n    </div>\r\n\r\n<!-- 两个canvas，一个主显示，一个主辅助 -->\r\n      <!-- canvas: mouseup时设置 -->\r\n      <!-- :width=\"canvasWidth\"\r\n      :height=\"canvasHeight\" -->\r\n      <!-- style: mouseup时设置 -->\r\n      <!-- width:canvasWidth+'px',\r\n      height:canvasHeight+'px', -->\r\n    <canvas id='display-canvas'\r\n      ref='display'\r\n      v-show=\"completeSelectRegion\"\r\n      :style=\"{\r\n        position:'absolute',\r\n        left:canvasX+'px',\r\n        top:canvasY+'px',\r\n        zIndex:999,\r\n        pointerEvents:'none'}\"\r\n      >\r\n    </canvas>\r\n\r\n    <!-- width/height：同上 -->\r\n    <canvas id='assist-canvas'\r\n      ref='assist'\r\n      v-show=\"completeSelectRegion\"\r\n      :style=\"{\r\n        position:'absolute',\r\n        left:canvasX+'px',\r\n        top:canvasY+'px',\r\n        zIndex:999,\r\n        cursor:'move'}\"\r\n      @mousedown=\"onDrag\">\r\n    </canvas>\r\n\r\n\r\n<!-- 工具条 -->\r\n    <ToolBar\r\n      @initSelect=\"initSelect()\"\r\n      @closeDrag=\"canDrag=false\"\r\n      v-position=\"{x,y,width,height}\"\r\n      v-show=\"completeSelectRegion\"\r\n      :toolbarBottom=\"toolbarBottom\"\r\n      :canvasProps=\"{canvasX,canvasY,canvasWidth,canvasHeight}\"\r\n      :clipDesktop=\"clipDesktop\"\r\n    />\r\n<!-- 颜色、位置提示框 -->\r\n    <ColorTip v-show=\"!isCapture\" v-if=\"showColorTip\"/>\r\n<!-- 桌面捕获 -->\r\n    <canvas id=\"desktop-canvas\" ref='desktop' :style=\"{visibility: win32? 'hidden':'visible'}\"></canvas>\r\n    <video id=\"video\"></video>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport ToolBar from \"./components/ToolBar\";\r\nimport ColorTip from './components/ColorTip'\r\nimport { captureScreen,setCanvas} from \"./utils/captureScreen\";\r\nimport {ipcRenderer} from 'electron'\r\n\r\nipcRenderer.on('flushDesktopCapture',()=>captureScreen()) //F1\r\n\r\nexport default {\r\n  name: \"app\",\r\n  components: {\r\n    ToolBar,\r\n    ColorTip\r\n  },\r\n  data() {\r\n    return {\r\n      x: 0,\r\n      y: 0,\r\n      width: 0,\r\n      height: 0,\r\n      win32:process.platform==='win32',\r\n\r\n      isCapture: false,\r\n      completeSelectRegion: false,\r\n      canDrag: true,\r\n\r\n      captureRegionStyle: {\r\n        position: \"absolute\",\r\n        zIndex: 99,\r\n        // cursor:'move',\r\n        background:'rgba(0,0,0,0)',\r\n        draggable: false,\r\n        borderWidth:'2px',\r\n        borderColor:this.$root.$data.captureColor,\r\n        borderStyle:'solid',\r\n        boxShadow: \"0px 0px 2px 2px rgba(85, 80, 80, 0.3)\",\r\n        left: \"0px\", // =this.x\r\n        top: \"0px\", // = this.y\r\n        width: \"0px\", //this.width\r\n        height: \"0px\" //this.height\r\n      },\r\n\r\n      showColorTip: this.$root.$data.showColorTip\r\n    };\r\n  },\r\n  mounted(){\r\n    captureScreen()\r\n  },\r\n  computed:{\r\n    toolbarBottom(){ //传给子组件，给colorpicker定位\r\n      return  this.$root.$data.screenHeight - (this.y+this.height+60+40)\r\n    },\r\n    canvasX(){\r\n      return this.x+parseInt(this.captureRegionStyle.borderWidth)\r\n    },\r\n    canvasY(){\r\n      return this.y+parseInt(this.captureRegionStyle.borderWidth)\r\n    },\r\n    canvasWidth(){\r\n      let width = this.width - 2*parseInt(this.captureRegionStyle.borderWidth)\r\n      return width>0? width:0\r\n    },\r\n    canvasHeight(){\r\n      let height = this.height - 2*parseInt(this.captureRegionStyle.borderWidth)\r\n      return height>0? height:0\r\n    }\r\n  },\r\n  methods: {\r\n    clipDesktop(){\r\n      let desktop = this.$refs.desktop\r\n      const ctx = this.$refs.display.getContext('2d')\r\n      ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight)\r\n      ctx.drawImage(\r\n        desktop,\r\n        this.canvasX,this.canvasY,this.canvasWidth,this.canvasHeight,\r\n        0,0,this.canvasWidth,this.canvasHeight\r\n      )\r\n      ctx.globalCompositeOperation = \"source-over\"\r\n    },\r\n    initSelect() {\r\n      //每次选择区域前初始化选区状态,也就是\"取消\"工具按钮作用\r\n      this.completeSelectRegion = false;\r\n      this.isCapture = false;\r\n      this.canDrag = true;\r\n      this.captureRegionStyle.left = '0px';\r\n      this.captureRegionStyle.top = '0px';\r\n      this.captureRegionStyle.width = '0px';\r\n      this.captureRegionStyle.height = '0px';\r\n    },\r\n    onSelectRegion(e) {\r\n      //鼠标按下开始截图\r\n      if (this.completeSelectRegion) {\r\n        return false;\r\n      } //选区成功后，不可再点击，除非点击\"取消\"重新选\r\n\r\n      // if(this.showPixelCanvas){\r\n      //   return false\r\n      // } //像素查看时，不可进行截图选取\r\n\r\n      this.initSelect();\r\n      this.x = e.clientX;\r\n      this.y = e.clientY;\r\n      this.captureRegionStyle.left = this.x + \"px\";\r\n      this.captureRegionStyle.top = this.y + \"px\";\r\n\r\n      document.onmousemove = e => {\r\n\r\n        const width = e.clientX - this.x; //可能反向选区,就为负数\r\n        const height = e.clientY - this.y;\r\n\r\n        // 判断是否是在截图，而不是纯粹点击鼠标等普通操作\r\n        this.isCapture = width > 15; //width<0是反向选区，但反向选区遇到bug，尚未解决\r\n        if (this.isCapture) {\r\n          //是在截图进行选区,更新宽高\r\n          this.width = width;\r\n          this.height = height;\r\n          this.captureRegionStyle.width = this.width + \"px\";\r\n          this.captureRegionStyle.height = this.height + \"px\";\r\n        }\r\n      }\r\n      document.onmouseup = () => { //BUG:偶尔丢失mouseup事件，我鼠标问题吗？\r\n        //放开鼠标，清除移动事件，生成选区\r\n        document.onmousemove = null;\r\n        this.completeSelectRegion = this.canDrag = this.isCapture;\r\n\r\n        //-------设置宽高、清空画布都会使canvas状态清空，所以在这里处理高dpi模糊问题\r\n        setCanvas(this.$refs.display,this.canvasWidth,this.canvasHeight)\r\n        setCanvas(this.$refs.assist,this.canvasWidth,this.canvasHeight)\r\n        //-------\r\n        this.clipDesktop()\r\n      }\r\n    },\r\n    onDrag(e) {\r\n      if (this.completeSelectRegion && this.canDrag) {\r\n        // 鼠标点击物体那一刻相对于物体左侧边框的距离=点击时的位置相对于浏览器\r\n        // 最左边的距离-物体左边框相对于浏览器最左边的距离，纵向同理\r\n        const leftWidth = e.clientX - this.x;\r\n        const topHeight = e.clientY - this.y;\r\n\r\n        document.onmousemove = e => {\r\n          this.completeSelectRegion = false; //移动时意味着重新选区，未完成选区隐藏工具条\r\n\r\n          // 控制拖拽物体的范围只能在浏览器视窗内，不允许出现滚动条或拖出可视区域\r\n          let posX = e.clientX - leftWidth;\r\n          let posY = e.clientY - topHeight;\r\n\r\n          if (posX < 0) {\r\n            posX = 0;\r\n          } else if (posX > document.body.clientWidth - this.width) {\r\n            posX = document.body.clientWidth - this.width;\r\n          }\r\n\r\n          if (posY < 0) {\r\n            posY = 0;\r\n          } else if (posY > document.body.clientHeight - this.height) {\r\n            posY = document.body.clientHeight - this.height;\r\n          }\r\n\r\n          //拖动\r\n          this.x = posX;\r\n          this.y = posY;\r\n          this.captureRegionStyle.left = this.x + \"px\";\r\n          this.captureRegionStyle.top = this.y + \"px\";\r\n        }\r\n\r\n        document.onmouseup = () => {\r\n          // 鼠标抬起时不再移动\r\n          // 预防鼠标弹起来后还会循环（即预防鼠标放上去的时候还会移动）\r\n          document.onmousemove = null;\r\n          this.completeSelectRegion = true; //重新选取完成，显示工具条\r\n\r\n          //-------设置宽高、清空画布都会使canvas状态清空，所以在这里处理高dpi模糊问题\r\n          setCanvas(this.$refs.display,this.canvasWidth,this.canvasHeight)\r\n          setCanvas(this.$refs.assist,this.canvasWidth,this.canvasHeight)\r\n          //------\r\n          this.clipDesktop()\r\n        };\r\n      }\r\n    }\r\n  },\r\n  directives: {\r\n    position: function(el, binding) {\r\n      //bind + update\r\n      let { x, y, width, height } = binding.value;\r\n      const { clientWidth, clientHeight } = document.body;\r\n      const toolbarLength = 555;\r\n      const toolbarHeight = 40;\r\n      const isBeyondLeft = (toolbarLength - width) / 2 > x; //左边碰壁了\r\n      const isBeyondRight =\r\n        (toolbarLength - width) / 2 > clientWidth - x - width; //右边碰壁了\r\n      const isBeyondBottom =\r\n        toolbarHeight + 20 > clientHeight - y - height; //下边碰壁了\r\n\r\n      el.style.position = \"absolute\";\r\n      el.style.zIndex = 999;\r\n      el.style.left = isBeyondLeft\r\n        ? \"10px\"\r\n        : isBeyondRight\r\n        ? clientWidth - toolbarLength - 20 + \"px\"\r\n        : x + width / 2 - toolbarLength / 2 + \"px\";\r\n      el.style.top = isBeyondBottom\r\n        ? y - 60 + \"px\"\r\n        : y + height + 40 + \"px\";\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\nhtml,\r\nbody {\r\n  width: 100%;\r\n  height: 100%;\r\n  margin: 0px;\r\n  padding: 0px;\r\n  box-sizing: border-box;\r\n  overflow: hidden;\r\n  background: rgba(0, 0, 0, 0.3); //关键在这里，调试时发现是#fff\r\n}\r\n#app,#layout {\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 1;\r\n  // background: rgba(0, 0, 0, 0.1);\r\n}\r\n#mask {\r\n  // background: rgba(0, 0, 0, 0.1);\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 99;\r\n}\r\n\r\n#desktop-canvas,\r\n#video {\r\n  position: absolute;\r\n  top: 0px;\r\n  left: 0px;\r\n  z-index: -999;\r\n  width: 100%;\r\n  height: 100%;\r\n  pointer-events: none;\r\n  visibility: hidden;\r\n}\r\n</style>\r\n","import mod from \"-!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../node_modules/_babel-loader@8.1.0@babel-loader/lib/index.js!../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=2e9afb92&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/_vue-loader@15.9.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\nimport { BootstrapVue, IconsPlugin } from 'bootstrap-vue'\nimport 'bootstrap/dist/css/bootstrap.css'\nimport 'bootstrap-vue/dist/bootstrap-vue.css'\n\nimport { remote } from 'electron'\nimport Store from 'electron-store'\n\n\nVue.use(BootstrapVue)\nVue.use(IconsPlugin)\n\nVue.config.productionTip = false\n\nconst store = new Store({name:'settings'})\n\nconst {\n  width: screenWidth,\n  height: screenHeight,\n} = remote.screen.getPrimaryDisplay().size\n\nnew Vue({\n  data() {\n    return {\n      screenWidth,\n      screenHeight,\n      theme:store.get('theme') || 'dark',\n      showColorTip: store.get('showColorTip'),\n      showMessage: store.get('showMessage'),\n      savePath: store.get('savePath') || remote.app.getPath('pictures'),\n      playSound: store.get('playSound'),\n      captureColor: store.get('captureColor') || \"#ffffff\",\n    }\n  },\n  render: h => h(App),\n}).$mount('#app')\n","module.exports = __webpack_public_path__ + \"img/brush.03c8929f.svg\";","import mod from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/_css-loader@3.4.2@css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./ToolBar.vue?vue&type=style&index=0&id=8baa6ef8&lang=less&scoped=true&\"; export default mod; export * from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/_css-loader@3.4.2@css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.1@vue-loader/lib/index.js??vue-loader-options!./ToolBar.vue?vue&type=style&index=0&id=8baa6ef8&lang=less&scoped=true&\"","module.exports = __webpack_public_path__ + \"media/iphone.abfdd1df.mp3\";","module.exports = require(\"events\");"],"sourceRoot":""}